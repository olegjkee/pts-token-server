<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🚀 PTS Project - Token Pump Station</title>
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🚀</text></svg>">
    
    <!-- Meta теги для соцсетей -->
    <meta name="description" content="PTS Project - Token Pump Station. Мониторинг и управление криптовалютными токенами в реальном времени.">
    <meta name="keywords" content="crypto, token, pump, blockchain, PTS, криптовалюта, токен">
    <meta name="author" content="PTS Project">
    
    <!-- Open Graph для соцсетей -->
    <meta property="og:title" content="🚀 PTS Project - Token Pump Station">
    <meta property="og:description" content="Мониторинг и управление криптовалютными токенами в реальном времени">
    <meta property="og:type" content="website">
    <meta property="og:image" content="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='1200' height='630' viewBox='0 0 1200 630'><rect width='1200' height='630' fill='%23232b2b'/><text x='600' y='350' text-anchor='middle' font-family='Arial' font-size='120' fill='%23ff3333'>🚀 PTS</text></svg>">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="🚀 PTS Project - Token Pump Station">
    <meta name="twitter:description" content="Мониторинг и управление криптовалютными токенами в реальном времени">
    
    <!-- Шрифты -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@900&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(-45deg, #2a4040, #1a3030, #2a4040, #1a3030, #0f2020, #2a4040);
            background-size: 600% 600%;
            animation: gradientBG 20s ease infinite;
            color: #fff;
            font-family: 'Montserrat', sans-serif;
            font-weight: 900;
            text-align: center;
            position: relative;
            overflow-x: hidden;
            min-height: 100vh;
        }
        
        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            25% { background-position: 100% 50%; }
            50% { background-position: 100% 100%; }
            75% { background-position: 0% 100%; }
            100% { background-position: 0% 50%; }
        }
        
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .particle {
            position: absolute;
            background: rgba(255, 0, 0, 0.1);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 0; }
            50% { transform: translateY(-100px) rotate(180deg); opacity: 1; }
        }
        
        .timer-container {
            margin: 30px 0 80px 0;
            padding: 18px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            max-width: 350px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .timer-text {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 10px;
        }
        
        .timer {
            font-size: 24px;
            color: #ff3333;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 700;
            text-shadow: 0 0 10px rgba(255, 51, 51, 0.5);
        }
        
        .decorative-dots {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 1;
        }
        
        .dot {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            animation: twinkle 3s ease-in-out infinite;
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.2; }
            50% { opacity: 1; }
        }
        
        .pulse-ring {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 200px;
            border: 2px solid rgba(255, 0, 0, 0.1);
            border-radius: 50%;
            animation: pulse 4s ease-in-out infinite;
            pointer-events: none;
            z-index: 0;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        header {
            background: linear-gradient(135deg, #6b9b9b, #5a8a8a, #4a7a7a);
            padding: 25px 0;
            width: 100%;
            position: relative;
            box-shadow: 
                0 10px 30px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #ff0000, #ff3333, #ff6666, #ff3333, #ff0000);
            background-size: 200% 100%;
            animation: headerGlow 3s ease-in-out infinite;
        }
        
        @keyframes headerGlow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        h1 {
            font-size: 52px;
            color: #b22222;
            margin: 0;
            padding-left: 40px;
            text-align: left;
            font-weight: 900;
            text-shadow: 
                2px 2px 4px rgba(0,0,0,0.5),
                0 0 20px rgba(178, 34, 34, 0.3);
            animation: titlePulse 4s ease-in-out infinite;
        }
        
        @keyframes titlePulse {
            0%, 100% { text-shadow: 2px 2px 4px rgba(0,0,0,0.5), 0 0 20px rgba(178, 34, 34, 0.3); }
            50% { text-shadow: 2px 2px 4px rgba(0,0,0,0.5), 0 0 30px rgba(178, 34, 34, 0.6); }
        }
        
        @keyframes rocketFloat {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-5px) rotate(5deg); }
        }
        
        .rocket-icon {
            animation: rocketFloat 3s ease-in-out infinite;
            display: inline-block;
        }
        
        .pump-text {
            font-size: 56px;
            margin: 120px 0 60px 0;
            color: #b22222;
            font-weight: 900;
            text-shadow: 
                2px 2px 4px rgba(0,0,0,0.5),
                0 0 30px rgba(178, 34, 34, 0.5);
            animation: textGlow 3s ease-in-out infinite alternate;
            position: relative;
        }
        
        @keyframes textGlow {
            from { 
                text-shadow: 2px 2px 4px rgba(0,0,0,0.5), 0 0 30px rgba(178, 34, 34, 0.5);
                transform: scale(1);
            }
            to { 
                text-shadow: 2px 2px 4px rgba(0,0,0,0.5), 0 0 40px rgba(178, 34, 34, 0.8);
                transform: scale(1.02);
            }
        }
        
        .info-text {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.6);
            margin: 40px 0 30px 0;
            font-weight: 400;
            background: rgba(255, 255, 255, 0.05);
            padding: 12px 20px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        #token-contract {
            border: 4px solid #ff0000;
            padding: 35px 45px;
            width: 85%;
            max-width: 1000px;
            margin: 60px auto;
            background: linear-gradient(135deg, #1a2626 0%, #0f1a1a 50%, #1a2626 100%);
            font-size: 28px;
            color: #fff;
            border-radius: 25px;
            font-family: 'JetBrains Mono', 'Consolas', 'Monaco', monospace;
            font-weight: 700;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            box-shadow: 
                0 15px 50px rgba(255, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.1),
                inset 0 -1px 0 rgba(0, 0, 0, 0.2),
                0 0 0 1px rgba(255, 0, 0, 0.2);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            letter-spacing: 2px;
            position: relative;
            overflow: visible;
            animation: contractPulse 6s ease-in-out infinite;
        }
        
        @keyframes contractPulse {
            0%, 100% { 
                box-shadow: 
                    0 15px 50px rgba(255, 0, 0, 0.4),
                    inset 0 1px 0 rgba(255, 255, 255, 0.1),
                    inset 0 -1px 0 rgba(0, 0, 0, 0.2),
                    0 0 0 1px rgba(255, 0, 0, 0.2);
            }
            50% { 
                box-shadow: 
                    0 20px 60px rgba(255, 0, 0, 0.6),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2),
                    inset 0 -1px 0 rgba(0, 0, 0, 0.2),
                    0 0 0 2px rgba(255, 0, 0, 0.4);
            }
        }
        
        #token-contract::before {
            content: '📋';
            position: absolute;
            right: 25px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 22px;
            opacity: 0.6;
            transition: all 0.3s ease;
            animation: iconFloat 3s ease-in-out infinite;
        }
        
        @keyframes iconFloat {
            0%, 100% { transform: translateY(-50%) scale(1); }
            50% { transform: translateY(-55%) scale(1.1); }
        }
        
        #token-contract::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #ff0000, #ff3333, #ff6666, #ff3333, #ff0000);
            background-size: 300% 300%;
            border-radius: 25px;
            z-index: -1;
            animation: borderGlow 4s ease-in-out infinite;
            opacity: 0;
        }
        
        @keyframes borderGlow {
            0%, 100% { 
                background-position: 0% 50%; 
                opacity: 0;
            }
            50% { 
                background-position: 100% 50%; 
                opacity: 0.3;
            }
        }
        
        #token-contract:hover {
            background: linear-gradient(135deg, #2a3636 0%, #1a2525 50%, #2a3636 100%);
            border-color: #ff3333;
            box-shadow: 
                0 25px 70px rgba(255, 0, 0, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.2),
                inset 0 -1px 0 rgba(0, 0, 0, 0.2),
                0 0 0 3px rgba(255, 0, 0, 0.4),
                0 0 50px rgba(255, 51, 51, 0.3);
            transform: translateY(-5px) scale(1.02);
        }
        
        #token-contract:hover::before {
            opacity: 1;
            transform: translateY(-50%) scale(1.2);
            animation: iconBounce 0.6s ease-in-out infinite;
        }
        
        @keyframes iconBounce {
            0%, 100% { transform: translateY(-50%) scale(1.2); }
            50% { transform: translateY(-45%) scale(1.3); }
        }
        
        #token-contract:hover::after {
            opacity: 0.5;
        }
        
        .floating-orbs {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .orb {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255, 0, 0, 0.2), transparent);
            animation: orbFloat 8s ease-in-out infinite;
        }
        
        @keyframes orbFloat {
            0%, 100% { 
                transform: translateY(0px) translateX(0px) scale(1);
                opacity: 0.3;
            }
            25% { 
                transform: translateY(-30px) translateX(20px) scale(1.1);
                opacity: 0.6;
            }
            50% { 
                transform: translateY(-10px) translateX(-15px) scale(0.9);
                opacity: 0.4;
            }
            75% { 
                transform: translateY(-25px) translateX(10px) scale(1.05);
                opacity: 0.5;
            }
        }
        
        .copy-notification {
            position: fixed;
            bottom: 40px; /* Внизу экрана */
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 700;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1000;
            box-shadow: 
                0 8px 32px rgba(76, 175, 80, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .copy-notification.show {
            opacity: 1;
            transform: translateX(-50%) translateY(-10px);
        }
        
        .copyright {
            position: fixed;
            bottom: 10px;
            right: 20px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.4); /* Полупрозрачный белый */
            font-family: 'Montserrat', sans-serif;
            font-weight: 400;
        }
        
        /* Оптимизация для мобильных устройств */
        @media (max-width: 768px) {
            h1 { font-size: 36px; padding-left: 20px; }
            .pump-text { font-size: 40px; margin: 80px 0 40px 0; }
            #token-contract { 
                width: 95%; 
                font-size: 20px; 
                padding: 25px 20px; 
                letter-spacing: 1px;
            }
            .timer-container, .info-text { max-width: 95%; font-size: 14px; }
            
            .admin-panel {
                width: 280px;
                right: 10px;
                top: 10px;
                transform: translateX(300px);
                font-size: 12px;
            }
            
            .admin-toggle {
                right: 20px;
                top: 20px;
                width: 40px;
                height: 40px;
                font-size: 20px;
            }
            
            .admin-section {
                padding: 12px;
                margin-bottom: 15px;
            }
            
            .admin-input {
                font-size: 11px;
                padding: 8px;
            }
            
            .admin-btn {
                padding: 6px 12px;
                font-size: 11px;
            }
            
            .token-item {
                font-size: 10px;
                padding: 6px;
            }
        }
        
        @media (max-width: 480px) {
            h1 { font-size: 28px; }
            .pump-text { font-size: 32px; }
            #token-contract { font-size: 16px; padding: 20px 15px; }
        }
        
        /* Отключение анимаций для пользователей с предпочтением уменьшенного движения */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
        
        /* Админ-панель */
        .admin-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 320px;
            background: linear-gradient(135deg, rgba(26, 38, 38, 0.9), rgba(15, 26, 26, 0.9));
            backdrop-filter: blur(15px);
            border: 2px solid rgba(255, 0, 0, 0.3);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            font-family: 'Montserrat', sans-serif;
            color: #fff;
            transform: translateX(340px);
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .admin-panel.open {
            transform: translateX(0);
        }
        
        .admin-toggle {
            position: fixed;
            top: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #ff0000, #cc0000);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 8px 20px rgba(255, 0, 0, 0.3);
            transition: all 0.3s ease;
            z-index: 1001;
            display: none; /* Скрываем кнопку по умолчанию */
        }
        
        .admin-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 25px rgba(255, 0, 0, 0.4);
        }
        
        .admin-section {
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .admin-section h3 {
            margin: 0 0 10px 0;
            font-size: 16px;
            color: #ff3333;
            font-weight: 700;
        }
        
        .admin-input {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #fff;
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
        }
        
        .admin-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        .admin-btn {
            background: linear-gradient(135deg, #ff0000, #cc0000);
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            font-size: 12px;
            margin: 5px 0;
            transition: all 0.3s ease;
        }
        
        .admin-btn:hover {
            background: linear-gradient(135deg, #ff3333, #ff0000);
            transform: translateY(-1px);
        }
        
        .admin-btn.secondary {
            background: linear-gradient(135deg, #666, #444);
        }
        
        .token-list {
            max-height: 150px;
            overflow-y: auto;
        }
        
        .token-item {
            background: rgba(255, 255, 255, 0.05);
            margin: 5px 0;
            padding: 8px;
            border-radius: 6px;
            font-size: 11px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .token-item.active {
            border-color: #ff0000;
            background: rgba(255, 0, 0, 0.1);
        }
        
        .token-name {
            font-weight: 600;
            color: #ff3333;
            margin-bottom: 3px;
        }
        
        .token-contract {
            font-family: 'JetBrains Mono', monospace;
            font-size: 10px;
            color: rgba(255, 255, 255, 0.7);
            word-break: break-all;
        }
        
        #nextTokenStatus {
            margin-top: 8px;
            font-size: 11px;
            padding: 8px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* Окно входа в админ-панель */
        .admin-login {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            backdrop-filter: blur(10px);
        }
        
        .admin-login.show {
            display: flex;
        }
        
        .admin-login-content {
            background: linear-gradient(135deg, rgba(26, 38, 38, 0.95), rgba(15, 26, 26, 0.95));
            padding: 30px;
            border-radius: 20px;
            border: 2px solid rgba(255, 0, 0, 0.3);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            text-align: center;
            min-width: 300px;
        }
        
        .admin-login-content h3 {
            color: #ff3333;
            margin-bottom: 20px;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <div class="particles" id="particles"></div>
    <div class="decorative-dots" id="decorative-dots"></div>
    <div class="floating-orbs" id="floating-orbs"></div>
    
    <header>
        <div style="display: flex; align-items: center; justify-content: space-between; max-width: 1200px; margin: 0 auto; padding: 0 40px;">
            <div style="display: flex; align-items: center; gap: 15px;">
                <span class="rocket-icon" style="font-size: 48px;">🚀</span>
                <div>
                    <h1 style="margin: 0; font-size: 52px; text-align: left;">PTS project</h1>
                    <p style="margin: 0; font-size: 16px; color: rgba(255,255,255,0.7); font-weight: 400;">Token Pump Station</p>
                </div>
            </div>
            <div style="text-align: right; color: rgba(255,255,255,0.6); font-size: 12px; font-weight: 400;">
                <div>🔥 Live Token Monitor</div>
                <div>⚡ Real-time Updates</div>
            </div>
        </div>
    </header>
    
    <div class="pulse-ring"></div>
    
    <p class="pump-text">pump this shit</p>
    
    <div id="token-contract" onclick="copyContract()" title="Click to copy">token contract address</div>
    
    <div class="info-text">🎲 Token is selected randomly from GMGN</div>
    
    <div class="timer-container">
        <div class="timer-text">Next token update in:</div>
        <div class="timer" id="countdown">Loading...</div>
    </div>
    
    <div id="copy-notification" class="copy-notification">Contract copied!</div>
    
    <div class="copyright">
        🚀 © 2024 PTS Project - Token Pump Station
    </div>
    
    <!-- Админ-панель -->
    <button class="admin-toggle" onclick="toggleAdminPanel()" title="Admin Panel">⚙️</button>
    
    <!-- Окно входа в админ-панель -->
    <div class="admin-login" id="adminLogin">
        <div class="admin-login-content">
            <h3>🔐 Вход в админ-панель</h3>
            <input type="password" class="admin-input" id="adminPasswordInput" placeholder="Введите пароль" onkeypress="handleLoginKeyPress(event)">
            <button class="admin-btn" onclick="adminLogin()">Войти</button>
            <button class="admin-btn secondary" onclick="closeAdminLogin()">Отмена</button>
        </div>
    </div>
    
    <div class="admin-panel" id="adminPanel">
        <div class="admin-section">
            <h3>🎯 Current Token</h3>
            <div id="currentTokenDisplay">Loading...</div>
        </div>
        
        <div class="admin-section">
            <h3>⏰ Timer Status</h3>
            <div id="timerInfo">Next update: <span id="adminTimer">--:--:--</span></div>
            <button class="admin-btn" onclick="resetTimer()">🔄 Reset Timer (2h)</button>
        </div>
        
        <div class="admin-section">
            <h3>🔧 Set Next Token</h3>
            <input type="text" class="admin-input" id="nextTokenName" placeholder="Token name (optional)">
            <input type="text" class="admin-input" id="nextTokenContract" placeholder="Contract address">
            <button class="admin-btn" onclick="setNextToken()">📌 Set Next Token</button>
            <div id="nextTokenStatus">No next token set</div>
        </div>
        
        <div class="admin-section">
            <h3>⚡ Manual Control</h3>
            <button class="admin-btn" onclick="switchTokenNow()" style="background: linear-gradient(135deg, #ff6600, #cc5500);">🔄 Switch Now</button>
            <button class="admin-btn secondary" onclick="refreshAdminPanel()">🔄 Refresh Panel</button>
            <button class="admin-btn secondary" onclick="logoutAdmin()" style="background: linear-gradient(135deg, #666, #444);">🚪 Выйти</button>
        </div>
    </div>

    <script>
        let currentContract = '';
        let nextUpdateTime = Date.now() + (2 * 60 * 60 * 1000); // 2 часа
        let allTokens = []; // Кэш всех токенов
        let adminPassword = ''; // Сохраненный пароль админа
        let isAdminAuthenticated = false;
        
        // Проверка производительности устройства
        function getDevicePerformance() {
            const isMobile = window.innerWidth <= 768;
            const isLowEnd = navigator.hardwareConcurrency <= 4 || isMobile;
            return { isMobile, isLowEnd };
        }

        // Создание плавающих орбов
        function createFloatingOrbs() {
            const { isLowEnd } = getDevicePerformance();
            const orbCount = isLowEnd ? 5 : 15; // Меньше орбов на слабых устройствах
            
            const orbsContainer = document.getElementById('floating-orbs');
            for (let i = 0; i < orbCount; i++) {
                const orb = document.createElement('div');
                orb.className = 'orb';
                orb.style.left = Math.random() * 100 + '%';
                orb.style.top = Math.random() * 100 + '%';
                orb.style.width = Math.random() * 60 + 20 + 'px';
                orb.style.height = orb.style.width;
                orb.style.animationDelay = Math.random() * 8 + 's';
                orb.style.animationDuration = (Math.random() * 6 + 6) + 's';
                orbsContainer.appendChild(orb);
            }
        }

        // Создание частиц
        function createParticles() {
            const { isLowEnd } = getDevicePerformance();
            const particleCount = isLowEnd ? 20 : 60; // Меньше частиц на слабых устройствах
            
            const particlesContainer = document.getElementById('particles');
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.width = Math.random() * 12 + 3 + 'px';
                particle.style.height = particle.style.width;
                particle.style.animationDelay = Math.random() * 6 + 's';
                particle.style.animationDuration = (Math.random() * 4 + 4) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Создание декоративных точек
        function createDecorativeDots() {
            const { isLowEnd } = getDevicePerformance();
            const dotCount = isLowEnd ? 40 : 120; // Меньше точек на слабых устройствах
            
            const dotsContainer = document.getElementById('decorative-dots');
            for (let i = 0; i < dotCount; i++) {
                const dot = document.createElement('div');
                dot.className = 'dot';
                dot.style.left = Math.random() * 100 + '%';
                dot.style.top = Math.random() * 100 + '%';
                dot.style.animationDelay = Math.random() * 3 + 's';
                dot.style.animationDuration = (Math.random() * 2 + 2) + 's';
                dotsContainer.appendChild(dot);
            }
        }

        // Обратный отсчет
        function updateCountdown() {
            const now = Date.now();
            const timeLeft = nextUpdateTime - now;
            
            if (timeLeft <= 0) {
                // При истечении времени синхронизируемся с сервером
                syncTimerWithServer();
                return;
            }
            
            const hours = Math.floor(timeLeft / (1000 * 60 * 60));
            const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
            
            document.getElementById('countdown').textContent = 
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        // Синхронизация таймера с сервером
        async function syncTimerWithServer() {
            try {
                const response = await fetch('/next-update-time');
                if (response.ok) {
                    const timeData = await response.json();
                    nextUpdateTime = timeData.nextUpdateTime;
                    console.log('🔄 Таймер пересинхронизирован:', new Date(nextUpdateTime));
                    
                    // Также обновляем токен
                    await fetchToken();
                }
            } catch (error) {
                console.error('Ошибка синхронизации таймера:', error);
                // В случае ошибки сбрасываем на 2 часа
                nextUpdateTime = Date.now() + (2 * 60 * 60 * 1000);
            }
        }

        async function copyContract() {
            if (!currentContract) {
                showNotification('Contract not loaded!');
                return;
            }

            try {
                await navigator.clipboard.writeText(currentContract);
                showNotification('Contract copied!');
            } catch (err) {
                // Fallback для старых браузеров
                const textArea = document.createElement('textarea');
                textArea.value = currentContract;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showNotification('Contract copied!');
            }
        }

        function showNotification(message) {
            const notification = document.getElementById('copy-notification');
            notification.textContent = message;
            notification.classList.add('show');
            setTimeout(() => {
                notification.classList.remove('show');
            }, 2000);
        }

        async function fetchToken() {
            try {
                console.log('Попытка получить токен...');
                const response = await fetch('/token');
                console.log('Ответ сервера:', response.status);
                
                if (!response.ok) {
                    throw new Error(`Сетевая ошибка: ${response.status}`);
                }
                
                const token = await response.json();
                console.log('Получен токен:', token);
                
                if (token && token.contract) {
                    currentContract = token.contract;
                    document.getElementById('token-contract').innerText = token.contract;
                    console.log('Контракт обновлен:', token.contract);
                } else {
                    document.getElementById('token-contract').innerText = 'Токен не найден';
                }
            } catch (error) {
                console.error('Ошибка при получении токена:', error);
                document.getElementById('token-contract').innerText = `Ошибка: ${error.message}`;
            }
        }

        // Инициализация при загрузке страницы
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('🚀 Страница загружена, запуск оптимизированного дизайна...');
            
            // Проверяем поддержку современных функций
            if (!window.requestAnimationFrame) {
                console.warn('Устройство не поддерживает современные анимации');
                return;
            }
            
            try {
                // Создаем визуальные эффекты с задержкой для плавной загрузки
                setTimeout(() => createFloatingOrbs(), 100);
                setTimeout(() => createParticles(), 200);
                setTimeout(() => createDecorativeDots(), 300);
                
                // Получаем данные с сервера
                await fetchToken();
                
                // Синхронизируем таймер с сервером
                try {
                    const response = await fetch('/next-update-time');
                    if (response.ok) {
                        const timeData = await response.json();
                        nextUpdateTime = timeData.nextUpdateTime;
                        console.log('⏰ Таймер синхронизирован с сервером:', new Date(nextUpdateTime));
                    }
                } catch (error) {
                    console.warn('Не удалось получить время с сервера, используется локальное');
                }
                
                // Обновление таймера каждую секунду
                setInterval(updateCountdown, 1000);
                setInterval(updateAdminTimer, 1000);
                updateCountdown();
                updateAdminTimer();
                
                // Периодическая синхронизация с сервером каждые 5 минут
                setInterval(syncTimerWithServer, 5 * 60 * 1000);
                
                // Добавляем интерактивность к плашке
                const tokenContract = document.getElementById('token-contract');
                if (tokenContract) {
                    tokenContract.addEventListener('mouseenter', () => {
                        tokenContract.style.animation = 'contractPulse 1s ease-in-out infinite';
                    });
                    tokenContract.addEventListener('mouseleave', () => {
                        tokenContract.style.animation = 'contractPulse 6s ease-in-out infinite';
                    });
                }
                
                // 🔐 Проверяем URL параметр для активации админки
                const urlParams = new URLSearchParams(window.location.search);
                if (urlParams.get('admin') === 'true') {
                    activateAdminMode();
                    // Очищаем URL для безопасности
                    window.history.replaceState({}, document.title, window.location.pathname);
                }
                
                console.log('✅ Все эффекты загружены успешно!');
            } catch (error) {
                console.error('Ошибка при инициализации эффектов:', error);
            }
        });

        // 🔐 Секретная активация админ-панели (Ctrl + Alt + A)
        let secretKeyCombo = [];
        document.addEventListener('keydown', function(event) {
            if (event.ctrlKey && event.altKey && event.code === 'KeyA') {
                event.preventDefault();
                activateAdminMode();
            }
        });
        
        function activateAdminMode() {
            const adminToggle = document.querySelector('.admin-toggle');
            if (adminToggle.style.display === 'block') {
                return; // Уже активирован
            }
            adminToggle.style.display = 'block';
            adminToggle.style.animation = 'pulse 0.6s ease-in-out';
            showNotification('🔐 Режим администратора активирован');
            console.log('🔐 Admin mode activated');
        }

        // Функции админ-панели
        function toggleAdminPanel() {
            if (!isAdminAuthenticated) {
                showAdminLogin();
                return;
            }
            const panel = document.getElementById('adminPanel');
            panel.classList.toggle('open');
            if (panel.classList.contains('open')) {
                refreshAdminPanel();
            }
        }
        
        function showAdminLogin() {
            document.getElementById('adminLogin').classList.add('show');
            document.getElementById('adminPasswordInput').focus();
        }
        
        function closeAdminLogin() {
            document.getElementById('adminLogin').classList.remove('show');
            document.getElementById('adminPasswordInput').value = '';
        }
        
        function handleLoginKeyPress(event) {
            if (event.key === 'Enter') {
                adminLogin();
            }
        }
        
        async function adminLogin() {
            const password = document.getElementById('adminPasswordInput').value;
            if (!password) {
                showNotification('Введите пароль');
                return;
            }
            
            try {
                const response = await fetch('/admin-login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ password })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    adminPassword = password;
                    isAdminAuthenticated = true;
                    closeAdminLogin();
                    toggleAdminPanel();
                    showNotification('✅ Вход выполнен успешно');
                } else {
                    showNotification('❌ Неверный пароль');
                    document.getElementById('adminPasswordInput').value = '';
                }
            } catch (error) {
                console.error('Ошибка входа:', error);
                showNotification('Ошибка подключения к серверу');
            }
        }
        
        function logoutAdmin() {
            isAdminAuthenticated = false;
            adminPassword = '';
            document.getElementById('adminPanel').classList.remove('open');
            
            // Полностью скрываем админ-режим
            const adminToggle = document.querySelector('.admin-toggle');
            adminToggle.style.display = 'none';
            
            showNotification('🚪 Выход выполнен - админ-режим скрыт');
        }
        
        async function refreshAdminPanel() {
            try {
                console.log('🔄 Начинаю обновление админ-панели...');
                
                const response = await fetch('/admin-status', {
                    headers: { 'x-admin-password': adminPassword }
                });
                console.log('📡 Ответ сервера:', response.status, response.statusText);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('📊 Полученные данные:', data);
                
                const { currentToken, nextToken, nextUpdateTime: serverUpdateTime } = data;
                
                // Проверяем наличие DOM элементов
                const currentTokenElement = document.getElementById('currentTokenDisplay');
                const nextTokenStatus = document.getElementById('nextTokenStatus');
                
                if (!currentTokenElement) {
                    console.error('❌ Элемент currentTokenDisplay не найден!');
                    throw new Error('DOM element currentTokenDisplay not found');
                }
                
                if (!nextTokenStatus) {
                    console.error('❌ Элемент nextTokenStatus не найден!');
                    throw new Error('DOM element nextTokenStatus not found');
                }
                
                // Обновляем отображение текущего токена
                if (currentToken) {
                    currentTokenElement.innerHTML = `
                        <div class="token-name">${currentToken.name}</div>
                        <div class="token-contract">${currentToken.contract}</div>
                    `;
                    console.log('✅ Текущий токен обновлен');
                } else {
                    console.warn('⚠️ Текущий токен отсутствует в данных');
                    currentTokenElement.innerHTML = '<div style="color: #ff6666;">No current token</div>';
                }
                
                // Обновляем статус следующего токена
                if (nextToken) {
                    nextTokenStatus.innerHTML = `
                        <div style="color: #4CAF50; font-size: 11px; margin-top: 8px;">
                            ✅ Next: <strong>${nextToken.name}</strong><br>
                            <span style="font-family: 'JetBrains Mono', monospace; color: rgba(255,255,255,0.7);">
                                ${nextToken.contract.substring(0, 20)}...
                            </span>
                        </div>
                    `;
                    console.log('✅ Следующий токен обновлен:', nextToken.name);
                } else {
                    nextTokenStatus.innerHTML = '<div style="color: #ff6666; font-size: 11px; margin-top: 8px;">❌ No next token set</div>';
                    console.log('ℹ️ Следующий токен не установлен');
                }
                
                // Обновляем время таймера
                if (serverUpdateTime) {
                    nextUpdateTime = serverUpdateTime;
                    updateAdminTimer();
                    console.log('⏰ Таймер обновлен');
                } else {
                    console.warn('⚠️ Время обновления отсутствует в данных');
                }
                
                console.log('✅ Админ-панель успешно обновлена');
                
            } catch (error) {
                console.error('❌ Ошибка при обновлении админ-панели:', error);
                console.error('Stack trace:', error.stack);
                
                // Показываем более информативное сообщение об ошибке
                const errorMessage = error.message.includes('fetch') 
                    ? 'Ошибка подключения к серверу'
                    : error.message.includes('DOM')
                    ? 'Ошибка интерфейса'
                    : `Ошибка загрузки: ${error.message}`;
                    
                showNotification(errorMessage);
            }
        }
        
        async function setNextToken() {
            const name = document.getElementById('nextTokenName').value || 'Custom Token';
            const contract = document.getElementById('nextTokenContract').value.trim();
            
            if (!contract) {
                showNotification('Please enter contract address');
                return;
            }
            
            try {
                console.log('Отправляю запрос:', { name, contract });
                
                const response = await fetch('/set-next-token', {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json',
                        'Accept': 'application/json',
                        'x-admin-password': adminPassword
                    },
                    body: JSON.stringify({ name, contract })
                });
                
                console.log('Ответ сервера:', response.status);
                
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`Server error: ${response.status} - ${errorText}`);
                }
                
                const result = await response.json();
                console.log('Результат:', result);
                
                if (result.success) {
                    document.getElementById('nextTokenName').value = '';
                    document.getElementById('nextTokenContract').value = '';
                    refreshAdminPanel();
                    showNotification(`Next token set: "${name}"`);
                } else {
                    showNotification(result.error || 'Failed to set token');
                }
            } catch (error) {
                console.error('Error setting next token:', error);
                showNotification(`Error: ${error.message}`);
            }
        }
        
        async function switchTokenNow() {
            try {
                const response = await fetch('/switch-now', {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json',
                        'x-admin-password': adminPassword
                    }
                });
                
                const result = await response.json();
                if (result.success) {
                    fetchToken(); // Обновляем основное отображение
                    refreshAdminPanel(); // Обновляем админ-панель
                    showNotification('Token switched manually!');
                } else {
                    showNotification('No next token to switch to');
                }
            } catch (error) {
                showNotification('Error switching token');
            }
        }
        
        async function resetTimer() {
            try {
                const response = await fetch('/reset-timer', {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json',
                        'x-admin-password': adminPassword
                    }
                });
                
                const result = await response.json();
                if (result.success) {
                    nextUpdateTime = result.nextUpdateTime;
                    showNotification('Timer reset to 2 hours!');
                    updateAdminTimer();
                }
            } catch (error) {
                showNotification('Error resetting timer');
            }
        }
        
        function updateAdminTimer() {
            const adminTimerElement = document.getElementById('adminTimer');
            if (adminTimerElement) {
                const now = Date.now();
                const timeLeft = nextUpdateTime - now;
                
                if (timeLeft > 0) {
                    const hours = Math.floor(timeLeft / (1000 * 60 * 60));
                    const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
                    
                    adminTimerElement.textContent = 
                        `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                } else {
                    adminTimerElement.textContent = '00:00:00';
                }
            } else {
                console.warn('⚠️ Элемент adminTimer не найден в DOM');
            }
        }
    </script>
</body>
</html>
